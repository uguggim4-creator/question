<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Question Slot Machine</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: url('./images/10.jpg') center/cover fixed;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 0;
        }

        .container {
            width: 90%;
            max-width: 600px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
            position: relative;
            z-index: 1;
            padding: 20px;
        }

        .reel-display {
            width: 100%;
            text-align: center;
            font-size: 24px;
            font-weight: 700;
            color: white;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
            padding: 20px 0;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 2px solid rgba(255, 255, 255, 0.8);
            opacity: 1;
            transition: opacity 0.3s ease;
        }

        .reel-display.hide {
            color: transparent;
        }

        .question-container {
            width: 100%;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.8s ease;
            position: absolute;
            left: 0;
            top: auto;
            bottom: auto;
        }

        .question-container.show {
            opacity: 1;
        }

        .question-text {
            font-size: 24px;
            font-weight: 600;
            color: white;
            line-height: 1.6;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            padding: 20px;
        }

        .spin-button {
            padding: 15px 50px;
            font-size: 18px;
            font-weight: 600;
            color: white;
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .spin-button:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }

        .spin-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .counter {
            font-size: 16px;
            font-weight: 500;
            color: white;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <div style="position: relative; width: 100%;">
            <div class="reel-display" id="reelDisplay">질문 뽑는중</div>
            <div class="question-container" id="questionContainer">
                <div class="question-text" id="questionText"></div>
            </div>
        </div>
        <button class="spin-button" id="spinButton">질문 뽑기</button>
        <div class="counter" id="counter">남은 질문: 20</div>
    </div>

    <script>
        const QUESTIONS = [
            "오늘이 영화라면, 그 영화는 무슨 장르?",
            "어느날 갑자기 동물로 변한다면 무슨 동물?",
            "최근 빠져 있는 취미나 관심사?",
            "오늘의 베스트 드레서는 누구?",
            "올해 가장 잘한 소비는?",
            "한달 휴가가 생기면 하고 싶은 것",
            "일주일 중에 가장 나를 기분 좋게 만드는 시간",
            "내년 나의 좌우명",
            "내가 타인에게 쉽게 주는 것 vs 쉽게 못 주는 것은? (칭찬/신뢰/시간/마음/사과 등)",
            "(공통 질문) 당신은 민초파?",
            "요즘 나에게 필요한 걸 고른다면? (휴식/도파민/정리/새로운 도전)",
            "어릴 때 좋아하던 것 중 아직도 좋아하는 것?",
            "체력 유지를 위해 요즘 꾸준히 실천하고 있는 루틴?",
            "경제적 자유를 얻는다면, 매일 하고 싶은 활동?",
            "아침 9시, 밤 11시 내가 더 집중 되는 시간?",
            "커피 vs 차 vs 술",
            "올해 마지막 날, 나 자신에게 해주고 싶은 말?",
            "내년의 나에게 꼭 해주고 싶은 당부?",
            "나의 버킷리스트 1위 항목?",
            "올해 나를 가장 바쁘게 했던 것.",
        ];

        const REEL_ITEMS = [
            '질문 뽑는중',
            '두구두구두',
            '따라란',
            '쿵짝짝',
            '빠빠밤',
        ];

        let selectedIndices = new Set();
        let isSpinning = false;
        let spinInterval = null;

        const spinButton = document.getElementById('spinButton');
        const reelDisplay = document.getElementById('reelDisplay');
        const questionContainer = document.getElementById('questionContainer');
        const questionText = document.getElementById('questionText');
        const counter = document.getElementById('counter');

        function updateCounter() {
            const remaining = QUESTIONS.length - selectedIndices.size;
            counter.textContent = `남은 질문: ${remaining}`;
        }

        function spin() {
            if (isSpinning) return;
            
            isSpinning = true;
            spinButton.disabled = true;
            
            // 이전 질문 숨기기
            questionContainer.classList.remove('show');
            
            // 릴 표시
            reelDisplay.classList.remove('hide');

            // 모든 질문이 선택되었으면 초기화
            if (selectedIndices.size === QUESTIONS.length) {
                selectedIndices.clear();
            }

            // 아직 선택되지 않은 질문 중에서 무작위 선택
            let selectedIndex;
            do {
                selectedIndex = Math.floor(Math.random() * QUESTIONS.length);
            } while (selectedIndices.has(selectedIndex));

            selectedIndices.add(selectedIndex);

            // 릴 아이템들을 순환
            let itemIndex = 0;
            spinInterval = setInterval(() => {
                reelDisplay.textContent = REEL_ITEMS[itemIndex % REEL_ITEMS.length];
                itemIndex++;

                // 총 20번 반복 후 멈춤
                if (itemIndex > 20) {
                    clearInterval(spinInterval);
                    
                    // 릴 숨기기
                    reelDisplay.classList.add('hide');
                    
                    // 최종 질문 표시
                    questionText.textContent = QUESTIONS[selectedIndex];
                    questionContainer.classList.remove('show');
                    
                    // 페이드인 전에 위치 조정
                    setTimeout(() => {
                        const textStyle = window.getComputedStyle(questionText);
                        const lineHeight = parseFloat(textStyle.lineHeight) || 24;
                        const textHeight = questionText.scrollHeight;
                        const lines = Math.round(textHeight / lineHeight);
                        const gap = 12;

                        // 위치 초기화 후 줄 수에 따라 배치
                        questionContainer.style.top = 'auto';
                        questionContainer.style.bottom = 'auto';

                        if (lines <= 1) {
                            // 1줄: 밑줄 바로 위 (릴 디스플레이와 같은 위치)
                            questionContainer.style.bottom = `calc(100% + ${gap}px)`;
                        } else {
                            // 2줄 이상: 한 줄 더 올림
                            questionContainer.style.bottom = `calc(100% + ${gap + lineHeight}px)`;
                        }

                        questionContainer.classList.add('show');
                        isSpinning = false;
                        spinButton.disabled = false;
                        updateCounter();
                    }, 100);
                }
            }, 150); // 150ms마다 변경
        }

        spinButton.addEventListener('click', spin);
        
        // 초기화
        questionText.textContent = QUESTIONS[0];
        updateCounter();
    </script>
</body>
</html>
